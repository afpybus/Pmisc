[{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Statistical Comparisons with comp_means","text":"comp_means() function Pmisc provides streamlined way perform pairwise statistical comparisons across multiple features two groups. automatically handles: Statistical tests two-group comparisons (t-test, Wilcoxon) P-value adjustment multiple testing Calculation fold changes mean differences Sample size validation Important: function designed comparing exactly two groups. multi-group comparisons, filter data two groups time. wraps powerful ggpubr package functions provide opinionated, high-throughput workflow. vignette demonstrates function using classic iris dataset, comparing two species time.","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"load-package","dir":"Articles","previous_headings":"","what":"Load Package","title":"Statistical Comparisons with comp_means","text":"","code":"library(Pmisc) library(dplyr) #> Warning: package 'dplyr' was built under R version 4.5.2 #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2) #> Warning: package 'ggplot2' was built under R version 4.5.2 library(tibble) #> Warning: package 'tibble' was built under R version 4.5.2"},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"basic-usage-comparing-two-groups","dir":"Articles","previous_headings":"","what":"Basic Usage: Comparing Two Groups","title":"Statistical Comparisons with comp_means","text":"Let’s compare petal sepal measurements two species: setosa versicolor.","code":"# Filter to two species for simplicity iris_subset <- iris %>%     mutate(Species = as.character(Species)) %>% # Convert factor to character     filter(Species %in% c(\"setosa\", \"versicolor\"))  # Define features to compare features <- c(\"Sepal.Length\", \"Sepal.Width\", \"Petal.Length\", \"Petal.Width\")  # Compare means between species results <- comp_means(     df = iris_subset,     feature_column_names = features,     group_column_name = \"Species\",     compare_means_method = \"t.test\",     p.adjust_method = \"fdr\" )  # View results results %>%     select(         feature, group1, group2, mean.group1, mean.group2,         mean_dif, p, p.adj, p.adj.signif     ) %>%     knitr::kable(digits = 3)"},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"understanding-the-output","dir":"Articles","previous_headings":"","what":"Understanding the Output","title":"Statistical Comparisons with comp_means","text":"comp_means() function returns data frame : feature: variable compared group1, group2: two groups compared mean.group1, mean.group2: Mean values group mean_dif: Difference means (group1 - group2) log2fc: Log2 fold change p: Raw p-value statistical test p.adj: Adjusted p-value (FDR correction) p.adj.signif: Significance level notation (ns, , , , ****) sig_increased_in: group higher values (significant)","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"volcano-plot-visualization","dir":"Articles","previous_headings":"","what":"Volcano Plot Visualization","title":"Statistical Comparisons with comp_means","text":"companion function volcano_cm() creates volcano plots visualize results:  plot shows: X-axis: Mean difference groups Y-axis: -log10(adjusted p-value) Horizontal line: p = 0.05 significance threshold Colors: group higher values Labels: Features significantly different","code":"# Define colors for significance # \"ns\" is gray, significant groups get specific colors sig_colors <- data.frame(     breaks = c(\"setosa\", \"versicolor\", \"ns\"),     values = c(\"#FF9999\", \"#99CC99\", \"grey80\"),     stringsAsFactors = FALSE )  # Create volcano plot with custom colors volcano_cm(     comp_means_output = results,     x = \"mean_dif\",     max_overlaps = 20 ) +     scm(sig_colors) + # Apply custom color scale     ggtitle(\"Setosa vs Versicolor: Feature Differences\") #> Warning in geom_text(aes(x = max(x_var) - 0.07 * sum(range(abs(x_var))), : All aesthetics have length 1, but the data has 4 rows. #> ℹ Please consider using `annotate()` or provide this layer with data containing #>   a single row."},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"wilcoxon-test-for-non-parametric-data","dir":"Articles","previous_headings":"","what":"Wilcoxon Test for Non-Parametric Data","title":"Statistical Comparisons with comp_means","text":"non-normal distributions, use Wilcoxon rank-sum test:","code":"# Compare using Wilcoxon test results_wilcox <- comp_means(     df = iris_subset,     feature_column_names = features,     group_column_name = \"Species\",     compare_means_method = \"wilcox.test\",     p.adjust_method = \"bonferroni\" )  # Compare p-values from t-test vs Wilcoxon comparison <- data.frame(     feature = features,     t_test_p = results$p.adj,     wilcox_p = results_wilcox$p.adj )  knitr::kable(comparison, digits = 5)"},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"visualizing-individual-features","dir":"Articles","previous_headings":"","what":"Visualizing Individual Features","title":"Statistical Comparisons with comp_means","text":"Use DEF_boxplot() visualize specific features p-value annotations:","code":"# Create boxplot for Petal.Length DEF_boxplot(     data = iris_subset,     DE = results,     feature = \"Petal.Length\",     grouping = \"Species\" ) +     ggtitle(\"Petal Length: Setosa vs Versicolor\")"},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"customizing-colors-with-sfm","dir":"Articles","previous_headings":"","what":"Customizing Colors with sfm()","title":"Statistical Comparisons with comp_means","text":"Similar scm(), sfm() (Scale Fill Manual) helper allows easily apply custom fill colors using tibble format.","code":"# Define color scheme for the species (reusing similar colors) my_colors <- data.frame(     breaks = c(\"setosa\", \"versicolor\", \"virginica\"),     values = c(\"#FF9999\", \"#99CC99\", \"#9999CC\"),     stringsAsFactors = FALSE )  # 2. Apply to DEF_boxplot using sfm() DEF_boxplot(     data = iris_subset,     DE = results,     feature = \"Petal.Length\",     grouping = \"Species\" ) +     sfm(my_colors) + # Apply custom fill colors     ggtitle(\"Petal Length with Custom Colors\")"},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"p-value-adjustment-methods","dir":"Articles","previous_headings":"","what":"P-Value Adjustment Methods","title":"Statistical Comparisons with comp_means","text":"function supports multiple adjustment methods: Note: single comparison, methods give result. differences appear comparing multiple features simultaneously.","code":"# Compare different adjustment methods adj_methods <- c(\"fdr\", \"bonferroni\", \"holm\")  adjustment_comparison <- lapply(adj_methods, function(method) {     res <- comp_means(         df = iris_subset,         feature_column_names = \"Petal.Length\",         group_column_name = \"Species\",         compare_means_method = \"t.test\",         p.adjust_method = method     )     data.frame(         method = method,         raw_p = res$p,         adj_p = res$p.adj     ) }) %>% bind_rows()  knitr::kable(adjustment_comparison, digits = 10)"},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Statistical Comparisons with comp_means","text":"comp_means() function provides: Flexible testing: Support t-test, Wilcoxon, ANOVA Multiple testing correction: FDR, Bonferroni, Holm, others Rich output: Means, fold changes, p-values, significance labels Integration: Works seamlessly volcano plots boxplots Sample size checking: Automatically removes features insufficient data makes ideal exploratory analysis, differential expression studies, comparing measurements across experimental groups.","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/comp_means.html","id":"related-functions","dir":"Articles","previous_headings":"","what":"Related Functions","title":"Statistical Comparisons with comp_means","text":"p.readjust(): Re-adjust p-values comp_means output volcano_cm(): Create volcano plots volcano_cm_labelall(): Volcano plot labeling points DEF_boxplot(): Boxplot p-value annotations DEF_boxplot_sig(): Boxplot significance stars","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Survival Analysis with Pmisc","text":"Pmisc package includes several functions survival analysis, making easy : Test multiple features association survival using Cox proportional hazards models Create publication-ready Kaplan-Meier survival curves Visualize survival results volcano plots Explore relationships gene expression overall survival functions provide streamlined wrapper around survival, tidycmprsk, ggsurvfit packages. vignette demonstrates functions using lung dataset survival package.","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load Packages","title":"Survival Analysis with Pmisc","text":"","code":"library(Pmisc) library(dplyr) library(ggplot2) library(survival) library(tibble) library(stringr)"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"the-lung-cancer-dataset","dir":"Articles","previous_headings":"","what":"The Lung Cancer Dataset","title":"Survival Analysis with Pmisc","text":"lung dataset contains survival data patients advanced lung cancer: Key variables: time: Survival time days status: Censoring status (1 = censored, 2 = dead) age: Age years sex: 1 = male, 2 = female ph.ecog: ECOG performance score (0-3)","code":"# Load the lung dataset data(lung) #> Warning in data(lung): data set 'lung' not found  # Preview the data head(lung) %>% knitr::kable() # Summary of key variables summary(lung[, c(\"time\", \"status\", \"age\", \"sex\", \"ph.ecog\")]) #>       time            status           age             sex        #>  Min.   :   5.0   Min.   :1.000   Min.   :39.00   Min.   :1.000   #>  1st Qu.: 166.8   1st Qu.:1.000   1st Qu.:56.00   1st Qu.:1.000   #>  Median : 255.5   Median :2.000   Median :63.00   Median :1.000   #>  Mean   : 305.2   Mean   :1.724   Mean   :62.45   Mean   :1.395   #>  3rd Qu.: 396.5   3rd Qu.:2.000   3rd Qu.:69.00   3rd Qu.:2.000   #>  Max.   :1022.0   Max.   :2.000   Max.   :82.00   Max.   :2.000   #>                                                                   #>     ph.ecog       #>  Min.   :0.0000   #>  1st Qu.:0.0000   #>  Median :1.0000   #>  Mean   :0.9515   #>  3rd Qu.:1.0000   #>  Max.   :3.0000   #>  NA's   :1"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"standardizing-the-data","dir":"Articles","previous_headings":"","what":"Standardizing the Data","title":"Survival Analysis with Pmisc","text":"Pmisc survival functions expect status coded 0/1 (0 = censored, 1 = event). Let’s prepare data:","code":"# Prepare the lung dataset lung_prep <- lung %>%     mutate(         status = status - 1, # Convert 1/2 to 0/1         sex_binary = sex - 1 # Convert to 0/1 for easier interpretation     ) %>%     filter(!is.na(time), !is.na(status)) # Remove missing values  # Verify the conversion table(lung_prep$status) #>  #>   0   1  #>  63 165"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"cox-proportional-hazards-analysis","dir":"Articles","previous_headings":"","what":"Cox Proportional Hazards Analysis","title":"Survival Analysis with Pmisc","text":"coxph_all() function tests multiple features simultaneously association survival: Interpreting results: Hazard ratio > 1: Higher feature values associated increased risk death Hazard ratio < 1: Higher feature values associated decreased risk death p.adj: Adjusted p-value (FDR correction) result: Classification (Increased Hazard, Decreased Hazard, ns) example: sex_binary shows decreased hazard (females better survival) ph.ecog shows increased hazard (worse performance status = worse survival)","code":"# Define features to test features <- c(\"age\", \"sex_binary\", \"ph.ecog\", \"ph.karno\", \"pat.karno\", \"wt.loss\")  # Run Cox proportional hazards for all features cox_results <- coxph_all(     df = lung_prep,     feature.names = features,     time_col = \"time\",     status_col = \"status\" )  # View results cox_results %>%     select(feature, n, hazard_ratio, wald_p, p.adj, p.signif, result) %>%     knitr::kable(digits = 4)"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"survival-volcano-plot","dir":"Articles","previous_headings":"","what":"Survival Volcano Plot","title":"Survival Analysis with Pmisc","text":"Visualize Cox regression results volcano plot:  Reading plot: X-axis: Hazard ratio (1.0 = effect) Y-axis: -log10(adjusted p-value) Vertical dashed line: Hazard ratio = 1 (effect) Horizontal dashed line: p = 0.05 significance threshold Colors: Direction effect (increased vs decreased hazard)","code":"survival_volcano(cox_results) +     ggtitle(\"Survival Analysis: Lung Cancer Dataset\")"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"customizing-volcano-colors-with-scm","dir":"Articles","previous_headings":"Survival Volcano Plot","what":"Customizing Volcano Colors with scm()","title":"Survival Analysis with Pmisc","text":"can control exact colors volcano plot using scm() helper:","code":"# Define custom colors for hazard categories volcano_colors <- data.frame(     breaks = c(\"Increased Hazard\", \"Decreased Hazard\", \"ns\"),     values = c(\"red3\", \"blue3\", \"grey80\"),     stringsAsFactors = FALSE )  # Apply to plot survival_volcano(cox_results) +     scm(volcano_colors) + # Apply custom color scale     ggtitle(\"Survival Volcano with Custom Colors\")"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"kaplan-meier-survival-curves","dir":"Articles","previous_headings":"","what":"Kaplan-Meier Survival Curves","title":"Survival Analysis with Pmisc","text":"KM_categorical() function creates Kaplan-Meier curves categorical continuous variables:","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"binary-variable-sex","dir":"Articles","previous_headings":"Kaplan-Meier Survival Curves","what":"Binary Variable: Sex","title":"Survival Analysis with Pmisc","text":"","code":"# Create categorical variable for sex lung_km <- lung_prep %>%     mutate(sex_cat = ifelse(sex_binary == 1, \"Female\", \"Male\"))  # Kaplan-Meier plot by sex KM_categorical(     df = lung_km,     gene = \"sex\", # Column name prefix     time_scale = \"Time (days)\",     reclass = FALSE # Don't split by median since already categorical )"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"continuous-variable-age","dir":"Articles","previous_headings":"Kaplan-Meier Survival Curves","what":"Continuous Variable: Age","title":"Survival Analysis with Pmisc","text":"continuous variables, KM_categorical() automatically splits median:","code":"# Kaplan-Meier plot for age (split at median) KM_categorical(     df = lung_prep,     gene = \"age\",     time_scale = \"Time (days)\",     reclass = TRUE # Split continuous variable at median ) +     ggtitle(\"Survival by Age (Median Split)\")"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"ecog-performance-score","dir":"Articles","previous_headings":"Kaplan-Meier Survival Curves","what":"ECOG Performance Score","title":"Survival Analysis with Pmisc","text":"","code":"# Create binary ECOG variable (good vs poor performance) lung_ecog <- lung_prep %>%     filter(!is.na(ph.ecog)) %>%     mutate(ph.ecog_cat = ifelse(ph.ecog <= 1, \"Good (0-1)\", \"Poor (2-3)\"))  KM_categorical(     df = lung_ecog,     gene = \"ph.ecog\",     time_scale = \"Time (days)\",     reclass = FALSE ) +     ggtitle(\"Survival by ECOG Performance Status\")"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"gene-expression-vs-overall-survival","dir":"Articles","previous_headings":"","what":"Gene Expression vs Overall Survival","title":"Survival Analysis with Pmisc","text":"gene_OS_scatter() function creates scatter plots showing relationship feature survival time:  Plot elements: point represents one patient Color indicates vital status (alive vs dead) Dashed lines show medians (survival time gene expression) Ellipses show 68% confidence regions Vertical line 60 months (5-year survival)","code":"gene_OS_scatter(     df = lung_prep,     gene = \"age\" ) +     ggtitle(\"Age vs Survival Time\") #> Warning: `aes_string()` was deprecated in ggplot2 3.0.0. #> ℹ Please use tidy evaluation idioms with `aes()`. #> ℹ See also `vignette(\"ggplot2-in-packages\")` for more information. #> ℹ The deprecated feature was likely used in the Pmisc package. #>   Please report the issue to the authors. #> This warning is displayed once per session. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated. # Another example: Weight loss vs survival lung_wt <- lung_prep %>% filter(!is.na(wt.loss))  gene_OS_scatter(     df = lung_wt,     gene = \"wt.loss\" ) +     ggtitle(\"Weight Loss vs Survival Time\")"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"complete-workflow-example","dir":"Articles","previous_headings":"","what":"Complete Workflow Example","title":"Survival Analysis with Pmisc","text":"’s complete analysis workflow:","code":"# 1. Prepare data lung_analysis <- lung %>%     mutate(         status = status - 1,         Female = (sex == 2) * 1,         Elderly = (age >= 65) * 1     ) %>%     filter(!is.na(time), !is.na(status))  # 2. Test multiple features features_test <- c(\"age\", \"Female\", \"Elderly\", \"ph.ecog\", \"ph.karno\", \"meal.cal\", \"wt.loss\")  cox_results_full <- coxph_all(     df = lung_analysis,     feature.names = features_test,     time_col = \"time\",     status_col = \"status\" )  # 3. View significant results cox_results_full %>%     filter(p.signif != \"ns\") %>%     select(feature, hazard_ratio, p.adj, result) %>%     arrange(p.adj) %>%     knitr::kable(digits = 4) # 4. Visualize results survival_volcano(cox_results_full) +     ggtitle(\"Survival Analysis: Comprehensive Feature Testing\")"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"advanced-custom-survival-analysis","dir":"Articles","previous_headings":"","what":"Advanced: Custom Survival Analysis","title":"Survival Analysis with Pmisc","text":"complex analyses, can combine Pmisc functions base survival functions:","code":"# Test interaction between sex and age lung_interaction <- lung_prep %>%     mutate(         age_group = cut(age,             breaks = c(0, 60, 70, 100),             labels = c(\"Young\", \"Middle\", \"Old\")         ),         sex_label = ifelse(sex_binary == 1, \"Female\", \"Male\")     ) %>%     filter(!is.na(age_group))  # Run Cox model with interaction cox_interaction <- coxph(Surv(time, status) ~ age_group * sex_label,     data = lung_interaction )  summary(cox_interaction) #> Call: #> coxph(formula = Surv(time, status) ~ age_group * sex_label, data = lung_interaction) #>  #>   n= 228, number of events= 165  #>  #>                                  coef exp(coef) se(coef)      z Pr(>|z|) #> age_groupMiddle               -0.1587    0.8533   0.3105 -0.511    0.609 #> age_groupOld                   0.1607    1.1743   0.3744  0.429    0.668 #> sex_labelMale                  0.3002    1.3502   0.2572  1.167    0.243 #> age_groupMiddle:sex_labelMale  0.3702    1.4480   0.3812  0.971    0.331 #> age_groupOld:sex_labelMale     0.3911    1.4786   0.4495  0.870    0.384 #>  #>                               exp(coef) exp(-coef) lower .95 upper .95 #> age_groupMiddle                  0.8533     1.1719    0.4643     1.568 #> age_groupOld                     1.1743     0.8516    0.5638     2.446 #> sex_labelMale                    1.3502     0.7407    0.8155     2.235 #> age_groupMiddle:sex_labelMale    1.4480     0.6906    0.6860     3.057 #> age_groupOld:sex_labelMale       1.4786     0.6763    0.6126     3.569 #>  #> Concordance= 0.608  (se = 0.026 ) #> Likelihood ratio test= 16.02  on 5 df,   p=0.007 #> Wald test            = 16.23  on 5 df,   p=0.006 #> Score (logrank) test = 16.91  on 5 df,   p=0.005"},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"interpreting-hazard-ratios","dir":"Articles","previous_headings":"","what":"Interpreting Hazard Ratios","title":"Survival Analysis with Pmisc","text":"HR = 1.0: effect survival HR = 2.0: Doubling risk (twice likely experience event) HR = 0.5: Halving risk (half likely experience event) Examples analysis: Female sex (HR ≈ 0.59): Females ~41% lower risk death males ECOG score (HR ≈ 1.62): 1-point increase ECOG score increases risk ~62%","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Survival Analysis with Pmisc","text":"Pmisc survival analysis functions provide: Batch testing coxph_all() - Test many features Automatic correction - FDR adjustment multiple testing Visual summaries - Volcano plots Kaplan-Meier curves Exploration tools - Scatter plots linking expression survival Sample size validation - Removes features insufficient data tools particularly useful : Biomarker discovery clinical studies Gene expression survival associations Prognostic factor identification Exploratory survival analysis","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/survival_analysis.html","id":"related-functions","dir":"Articles","previous_headings":"","what":"Related Functions","title":"Survival Analysis with Pmisc","text":"coxph_all(): Cox proportional hazards multiple features survival_volcano(): Volcano plot survival results KM_categorical(): Kaplan-Meier survival curves gene_OS_scatter(): Gene expression vs overall survival scatter plot","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Set Visualization with Upset Plots","text":"Upset plots provide powerful alternative Venn diagrams visualizing set intersections, especially dealing 3-4 sets. Pmisc package provides two main functions: upset_plot(): Creates main intersection plot upset_side(): Creates side panels showing individual set sizes functions built top excellent ggupset package, simplifying creation publication-ready figures. vignette demonstrates functions using mtcars dataset.","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load Packages","title":"Set Visualization with Upset Plots","text":"","code":"library(Pmisc) library(dplyr) #> Warning: package 'dplyr' was built under R version 4.5.2 #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2) #> Warning: package 'ggplot2' was built under R version 4.5.2 library(tibble) #> Warning: package 'tibble' was built under R version 4.5.2"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"creating-binary-membership-data","dir":"Articles","previous_headings":"","what":"Creating Binary Membership Data","title":"Set Visualization with Upset Plots","text":"First, let’s create binary (TRUE/FALSE) membership data mtcars dataset based various characteristics: row represents car, column indicates membership set (TRUE = member, FALSE = member).","code":"# Create binary indicators for different car characteristics mtcars_binary <- mtcars %>%     mutate(         HighMPG = mpg > median(mpg),         HighHP = hp > median(hp),         FourCylinder = cyl == 4,         Automatic = am == 0,         V_Engine = vs == 0     ) %>%     select(HighMPG, HighHP, FourCylinder, Automatic, V_Engine)  # Preview the data head(mtcars_binary) %>% knitr::kable()"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"basic-upset-plot","dir":"Articles","previous_headings":"","what":"Basic Upset Plot","title":"Set Visualization with Upset Plots","text":"Create basic upset plot showing set intersections:  Reading plot: x-axis shows different combinations sets (connected dots bars) y-axis shows count items intersection Connected dots indicate sets part intersection","code":"upset_plot(mtcars_binary) #> Warning: There was 1 warning in `mutate()`. #> ℹ In argument: `aggregate = list(c_across())`. #> ℹ In row 1. #> Caused by warning: #> ! Using `c_across()` without supplying `cols` was deprecated in dplyr 1.1.0. #> ℹ Please supply `cols` instead. #> ℹ The deprecated feature was likely used in the Pmisc package. #>   Please report the issue to the authors. #> Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #> ℹ Please use `linewidth` instead. #> ℹ The deprecated feature was likely used in the ggupset package. #>   Please report the issue at <https://github.com/const-ae/ggupset/issues>. #> This warning is displayed once per session. #> Call `lifecycle::last_lifecycle_warnings()` to see where this warning was #> generated."},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"customizing-text-size","dir":"Articles","previous_headings":"","what":"Customizing Text Size","title":"Set Visualization with Upset Plots","text":"presentations publications, can adjust text size:","code":"upset_plot(mtcars_binary, cex.text = 1.2)"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"side-panels-set-sizes","dir":"Articles","previous_headings":"","what":"Side Panels: Set Sizes","title":"Set Visualization with Upset Plots","text":"upset_side() function creates bar charts showing total size individual set:   Interpretation: bar shows many cars belong set left panel shows counts left percentages right panel shows counts right","code":"# Left side panel upset_side(mtcars_binary, side = \"left\") # Right side panel (without percentages) upset_side(mtcars_binary, side = \"right\", add_percent = FALSE)"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"combining-upset-plot-with-side-panel","dir":"Articles","previous_headings":"","what":"Combining Upset Plot with Side Panel","title":"Set Visualization with Upset Plots","text":"publication-quality figures, combine upset plot side panel:","code":"# Create both plots main_plot <- upset_plot(mtcars_binary, cex.text = 1.1) side_plot <- upset_side(mtcars_binary, side = \"left\", cex.text = 1.1)  # Combine using make_grid make_grid(list(side_plot, main_plot), nrow = 1, ncol = 2)"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"working-with-different-set-sizes","dir":"Articles","previous_headings":"","what":"Working with Different Set Sizes","title":"Set Visualization with Upset Plots","text":"Let’s create complex example additional characteristics:","code":"# Create more detailed binary classifications mtcars_expanded <- mtcars %>%     mutate(         HeavyWeight = wt > median(wt),         FastQuarterMile = qsec < median(qsec),         FourGears = gear == 4,         MultiCarb = carb > 2     ) %>%     select(HeavyWeight, FastQuarterMile, FourGears, MultiCarb)  # Create upset plot upset_plot(mtcars_expanded)"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"using-custom-binary-values","dir":"Articles","previous_headings":"","what":"Using Custom Binary Values","title":"Set Visualization with Upset Plots","text":"functions work binary indicator, just TRUE/FALSE. can specify value treat “TRUE”:","code":"# Create data with 1/0 instead of TRUE/FALSE mtcars_numeric <- mtcars_binary * 1 # Convert TRUE/FALSE to 1/0  # Use value = 1 to indicate membership upset_plot(mtcars_numeric, value = 1) # Works with any value mtcars_text <- mtcars_binary %>%     mutate(across(everything(), ~ ifelse(.x, \"Yes\", \"No\")))  upset_plot(mtcars_text, value = \"Yes\")"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"real-world-example-plant-species-traits","dir":"Articles","previous_headings":"","what":"Real-World Example: Plant Species Traits","title":"Set Visualization with Upset Plots","text":"Let’s use iris dataset show species -median measurements:","code":"# Create binary indicators for above-median measurements iris_binary <- iris %>%     mutate(         LargeSepalLength = Sepal.Length > median(Sepal.Length),         LargeSepalWidth = Sepal.Width > median(Sepal.Width),         LargePetalLength = Petal.Length > median(Petal.Length),         LargePetalWidth = Petal.Width > median(Petal.Width)     ) %>%     select(LargeSepalLength, LargeSepalWidth, LargePetalLength, LargePetalWidth)  # Create combined visualization iris_upset <- upset_plot(iris_binary, cex.text = 1.1) iris_side <- upset_side(iris_binary, side = \"left\", cex.text = 1.1)  make_grid(list(iris_side, iris_upset), nrow = 1, ncol = 2)"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"interpreting-results","dir":"Articles","previous_headings":"","what":"Interpreting Results","title":"Set Visualization with Upset Plots","text":"iris example : side panel shows individual set sizes (e.g., many flowers large petal length) upset plot shows intersections (e.g., many flowers large petal length large petal width) Single dots represent flowers belonging one set Connected dots represent flowers belonging multiple sets simultaneously","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"comparison-to-venn-diagrams","dir":"Articles","previous_headings":"","what":"Comparison to Venn Diagrams","title":"Set Visualization with Upset Plots","text":"Upset plots offer several advantages:","code":""},{"path":[]},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"adjusting-side-panel-expansion","dir":"Articles","previous_headings":"Customization Options","what":"Adjusting Side Panel Expansion","title":"Set Visualization with Upset Plots","text":"Control white space side panels:","code":"upset_side(mtcars_binary, side = \"right\", expand = 0.3, add_percent = FALSE)"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"combining-with-additional-styling","dir":"Articles","previous_headings":"Customization Options","what":"Combining with Additional Styling","title":"Set Visualization with Upset Plots","text":"Since output ggplot object, can add additional styling:","code":"upset_plot(mtcars_binary, cex.text = 1.1) +     theme_minimal() +     theme(         plot.background = element_rect(fill = \"white\", color = NA),         panel.grid.major = element_line(color = \"gray90\")     )"},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Set Visualization with Upset Plots","text":"Pmisc upset plot functions provide: Clean visualization set intersections Scalability many sets (unlike Venn diagrams) Exact counts intersection Side panels show individual set sizes Customization options text size appearance Flexibility work binary indicator variable tools particularly useful : Gene set analysis (genes multiple pathways) Clinical data (patients combinations conditions) Survey data (respondents selected combinations options) Quality control (samples pass multiple criteria)","code":""},{"path":"https://afpybus.github.io/Pmisc/articles/upset_plots.html","id":"related-functions","dir":"Articles","previous_headings":"","what":"Related Functions","title":"Set Visualization with Upset Plots","text":"upset_plot(): Main upset plot showing set intersections upset_side(): Side panel showing individual set sizes make_grid(): Combine multiple plots grid layout","code":""},{"path":"https://afpybus.github.io/Pmisc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Alyssa Pybus. Maintainer.","code":""},{"path":"https://afpybus.github.io/Pmisc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pybus (2026). Pmisc: Personal R Utility Functions. R package version 0.1.0.","code":"@Manual{,   title = {Pmisc: Personal R Utility Functions},   author = {Alyssa Pybus},   year = {2026},   note = {R package version 0.1.0}, }"},{"path":"https://afpybus.github.io/Pmisc/index.html","id":"pmisc","dir":"","previous_headings":"","what":"Personal R Utility Functions","title":"Personal R Utility Functions","text":"Personal R package containing utility functions data analysis, visualization, statistics, survival analysis, .","code":""},{"path":"https://afpybus.github.io/Pmisc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Personal R Utility Functions","text":"","code":"# Install pacman if you don't have it install.packages(\"pacman\")  # Install and load Pmisc from GitHub pacman::p_load_gh(\"afpybus/Pmisc\")"},{"path":"https://afpybus.github.io/Pmisc/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Personal R Utility Functions","text":"Load package R script project:","code":"pacman::p_load_gh(\"afpybus/Pmisc\")  # Now all functions are available # Examples:  # Get significance notation add_sig(0.03)  # Returns \"*\"  # length(unique(x)) lu(c(\"a\", \"a\", \"b\", \"c\", \"c\", \"c\"))  # Returns 3"},{"path":"https://afpybus.github.io/Pmisc/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"Personal R Utility Functions","text":"package includes detailed vignettes demonstrating key functions using common training datasets: Statistical Comparisons comp_means: Learn compare means across groups, perform statistical tests, create volcano plots using iris dataset. Set Visualization Upset Plots: Create publication-quality upset plots visualizing set intersections combinations using mtcars iris datasets. Survival Analysis: Perform Cox proportional hazards analysis, create Kaplan-Meier curves, visualize survival results using lung cancer dataset. browse vignettes installing package:","code":"# Install with vignettes devtools::install_github(\"afpybus/Pmisc\", build_vignettes = TRUE)  # Browse vignettes browseVignettes(\"Pmisc\")  # Open a specific vignette vignette(\"comp_means\", package = \"Pmisc\") vignette(\"upset_plots\", package = \"Pmisc\") vignette(\"survival_analysis\", package = \"Pmisc\")"},{"path":"https://afpybus.github.io/Pmisc/index.html","id":"function-categories","dir":"","previous_headings":"","what":"Function Categories","title":"Personal R Utility Functions","text":"Utility Functions: add_sig(), lu(), tibble_to_mat(), slope(), earliest(), latest() Figure Helpers: scm(), sfm(), geom_vb(), title_format(), bar.counts(), make_grid(), png_pdf(), ggplotColours() Data Manipulation: rm_from_array(), gsub_colnames(), get_upper_tri(), get_lower_tri(), reorder_cormat() Stat Functions: comp_means(), p.readjust(), volcano_cm(), corr_across(), remove_outliers(), DEF_boxplot() Spatial Analysis: make_pairs() Survival Analysis: coxph_all(), survival_volcano(), KM_categorical(), gene_OS_scatter() Heatmaps: cor_hm(), color.bar() Upset Plots: upset_plot(), upset_side() OPLS: rotate_opls()","code":""},{"path":"https://afpybus.github.io/Pmisc/index.html","id":"updating-the-package","dir":"","previous_headings":"","what":"Updating the Package","title":"Personal R Utility Functions","text":"update latest version GitHub:","code":"pacman::p_load_gh(\"afpybus/Pmisc\")"},{"path":"https://afpybus.github.io/Pmisc/index.html","id":"acknowledgments","dir":"","previous_headings":"","what":"Acknowledgments","title":"Personal R Utility Functions","text":"package wraps extends functionality several excellent R packages. Special credit core packages powering utilities: ggpubr: Powers statistical comparisons visualization foundations. ggupset: engine behind upset plot visualizations. survival, tidycmprsk, & ggsurvfit: Provide robust statistical engines survival analysis.","code":""}]
